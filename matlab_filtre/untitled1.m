clc;
clear;

syms s;

r1 = (s+1);
r2 = (s^2 + 0.12558*s +1);
r3 = (s^2 + 0.37476*s +1);
r4 = (s^2 + 0.61703*s +1);
r5 = (s^2 + 0.85155*s +1);
r6 = (s^2 + 1.0716*s +1);
r7 = (s^2 + 1.27485*s +1);
r8 = (s^2 + 1.4579*s +1);
r9 = (s^2 + 1.61805*s +1);
r10 = (s^2 + 1.75265*s +1);
r11 = (s^2 + 1.85955*s +1);
r12 = (s^2 + 1.9371*s +1);
r13 = (s^2 + 1.9842*s +1);

B(s) = r1*r2*r3*r4*r5*r6*r7*r8*r9*r10*r11*r12*r13;

c = coeffs(B);

Pay_H_s=[1];
Payda_H_s = [1, 796241/50000, 50720314329/400000000, 335661822905077837/500000000000000, 53029755693404695105651/20000000000000000000, 1662089271290963062163741247/200000000000000000000000, 171754781967782403451123187393159/8000000000000000000000000000, 3750494332818847885896528919464543863/80000000000000000000000000000000, 70439667502925909530153646024879970361653/800000000000000000000000000000000000, 1151966167841238724216081429361057605230322677/8000000000000000000000000000000000000000, 4136807714347390981026944550134023698133712645259/20000000000000000000000000000000000000000000, 10500743108033763027031670566608757470633415101187809/40000000000000000000000000000000000000000000000, 147742199346316004371640291368449279173791270660511255703/500000000000000000000000000000000000000000000000000, 147742199346316004371640291368449279173791270660511255703/500000000000000000000000000000000000000000000000000, 10500743108033763027031670566608757470633415101187809/40000000000000000000000000000000000000000000000, 4136807714347390981026944550134023698133712645259/20000000000000000000000000000000000000000000, 1151966167841238724216081429361057605230322677/8000000000000000000000000000000000000000, 70439667502925909530153646024879970361653/800000000000000000000000000000000000, 3750494332818847885896528919464543863/80000000000000000000000000000000, 171754781967782403451123187393159/8000000000000000000000000000, 1662089271290963062163741247/200000000000000000000000, 53029755693404695105651/20000000000000000000, 335661822905077837/500000000000000, 50720314329/400000000, 796241/50000, 1];
Fs = 4*10^3;

[LP_Pay,LP_Payda]=lp2lp(Pay_H_s,Payda_H_s,2*pi*300);
[H_jw_surekli_zaman_LP, w_surekli_zaman_LP]=freqs(LP_Pay,LP_Payda,512);
figure;
grid on;
plot(w_surekli_zaman_LP,abs(H_jw_surekli_zaman_LP))
xlabel('w (rad/sn)')
title('Analog Filtre')

[Pay_H_z_LP_bilinear,Payda_H_z_LP_bilinear]=bilinear(LP_Pay,LP_Payda,Fs);
[H_jw_ayrik_zaman_LP_bilinear, w_ayrik_zaman_LP_bilinear]=freqz(Pay_H_z_LP_bilinear,Payda_H_z_LP_bilinear,512);
figure;
grid on;
plot(Fs.*w_ayrik_zaman_LP_bilinear,abs(H_jw_ayrik_zaman_LP_bilinear));
xlabel('W')
title('Dijital Filtre')

