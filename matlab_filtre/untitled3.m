clc;
clear;

syms z s

Fs = 4*10^3;
Ts = 1/Fs;
wpyeni = atan(Ts*2*pi*300)/Ts; %% Ön sarma etkisi
wsyeni = atan(Ts*2*pi*400)/Ts;

frekans_pass = wpyeni/(2*pi);
frekans_stop = wsyeni/(2*pi);

z_p = 4.2441*(z-1); %% s'den z'ye bilineer dönüşüm 
b = (z+1);
c = (z+1)^2;

r0 = (z+1)^25;
r1 = z_p*b + 1*c;
r2 = z_p^2 + 0.12558*z_p*b +1*c;
r3 = z_p^2 + 0.37476*z_p*b +1*c;
r4 = z_p^2 + 0.61703*z_p*b +1*c;
r5 = z_p^2 + 0.85155*z_p*b +1*c;
r6 = z_p^2 + 1.0716*z_p*b  +1*c;
r7 = z_p^2 + 1.27485*z_p*b +1*c;
r8 = z_p^2 + 1.4579*z_p*b  +1*c;
r9 = z_p^2 + 1.61805*z_p*b +1*c;
r10 = z_p^2 + 1.75265*z_p*b +1*c;
r11 = z_p^2 + 1.85955*z_p*b +1*c;
r12 = z_p^2 + 1.9371*z_p*b +1*c;
r13 = z_p^2 + 1.9842*z_p*b +1*c;

H_Pay(z) = r0;
H_Payda(z) = r1*r2*r3*r4*r5*r6*r7*r8*r9*r10*r11*r12*r13;

% c1 = coeffs(H_Pay);
% c2 = coeffs(H_Payda);

c1 = eval(coeffs(H_Pay));
c2 = eval(coeffs(H_Payda));
c1 = c1./(c2(1)) %Turn into proper polynomial, first coeffs of a is 1
c2 = c2./(c2(1))

% ls = [-11979475256982051996514118366483123461220196223067694952443202212379155964829694326546075564101651556099/14551915228366851806640625000000000000000000000000000000000000000000000000000000000000000, 9469679268420669692801496592726699442409792730773976401803468867127240181424385567382633445387693929636561/363797880709171295166015625000000000000000000000000000000000000000000000000000000000000000, -36022073951979269433655883309518246215892422957827049745648487284086286834417683715493121850247091090138399/90949470177292823791503906250000000000000000000000000000000000000000000000000000000000000, 8776925418830743964098105208995209693269375401848207954504948367621916827493057584383333108778408928397793269/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, -123054746830836853951325207001640934876599130086561852568705040487983408565078546135124023681683684513865725363/4547473508864641189575195312500000000000000000000000000000000000000000000000000000000000000, 660494937700470625726052733175983558219836206004759865825416750757203647690907123465969479508856521748735108201/4547473508864641189575195312500000000000000000000000000000000000000000000000000000000000000, -1410659462246860262591087221471394578598051149853158326663328645154547890872389028937970680895419178563644450347/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, 4920266210599262115770966243080023540957812780739132278665875878821786641535042089801129253500652198117648260033/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, -57065678275459134690105389596266769409025416618940433680622481556546339025758679093215610084459540329725440126077/9094947017729282379150390625000000000000000000000000000000000000000000000000000000000000000, 139311121070335667869924764233691949798861811335018919778680606196444024318873149316167475539818674439063526441799/9094947017729282379150390625000000000000000000000000000000000000000000000000000000000000000, -36116833578355777558134587109924765762023613828147238688697626100834386808935160359628144906602275737780368841447/1136868377216160297393798828125000000000000000000000000000000000000000000000000000000000000, 64035701387389273153665599405605393420854905657787465875293527039362277644922863012604857708310120916140730562901/1136868377216160297393798828125000000000000000000000000000000000000000000000000000000000000, -194879053751214633289414232539500619089769895042887366305265570526650649757897536503163773437539707641648951949797/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, 254986792132216473318641882312706805670972489888336167211013055675700174089775434287605598605558558104947824989983/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, -28691002146778494863347756622295906864853771700331834039931950214005442031041185747809042582929924184662950347259/227373675443232059478759765625000000000000000000000000000000000000000000000000000000000000, 138564617750854032186205181992562360644648030741010890594230615244464938521925329597313049162124662676051275263157/1136868377216160297393798828125000000000000000000000000000000000000000000000000000000000000, -915710673055370762818650037387149178226098849982851506443033219342707649900355028394091683635169109245298882913917/9094947017729282379150390625000000000000000000000000000000000000000000000000000000000000000, 128606025715020579177108445549312198258175558603106141618277370615394190096913706542904460900591551530736164019483/1818989403545856475830078125000000000000000000000000000000000000000000000000000000000000000, -95116814468837579043850961403659435987325368989981785659529672085878651360735843724717068540418117706575688523563/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, 46828222555304159506958732896171614473499099577351695967449251046083372332509909050241543628722412294296301875553/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, -37692414546157297741786469223530865193298357772486009733191996589073473021309471974400170372974891368212482605491/4547473508864641189575195312500000000000000000000000000000000000000000000000000000000000000, 12087708794733115740268384237291946175062171360708901776302051357710142540060944368048370699870219019353464029161/4547473508864641189575195312500000000000000000000000000000000000000000000000000000000000000, -1486257357633376821624506877049411627345318301014133668615043234917513665813395373386376393174568394707174763271/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, 263327978693088080821277843498969094914373865259330229278123650449443196763065310422693824046614511568454286549/2273736754432320594787597656250000000000000000000000000000000000000000000000000000000000000, -4790496063844765395003500217806882113828317500540031484542027450743421416529609432284426569326285828524773707/363797880709171295166015625000000000000000000000000000000000000000000000000000000000000000, 262660140973593793617558037105017417064022209251412574368666491793507878324127040032833927463415892265506321/363797880709171295166015625000000000000000000000000000000000000000000000000000000000000000];
% rs = [1, 25, 300, 2300, 12650, 53130, 177100, 480700, 1081575, 2042975, 3268760, 4457400, 5200300, 5200300, 4457400, 3268760, 2042975, 1081575, 480700, 177100, 53130, 12650, 2300, 300, 25, 1];
H(z) = H_Pay/H_Payda;

[H_jw_ayrik_zaman_LP_bilinear, w_ayrik_zaman_LP_bilinear]=freqz(double(c1),double(c2),512);
grid on;
plot(Fs.*w_ayrik_zaman_LP_bilinear,abs(H_jw_ayrik_zaman_LP_bilinear));
xlabel('W')
title('Dijital Filtre')

